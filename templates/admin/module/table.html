{% extends "layouts/admin.html" %}

{% block top  %}
	<section id="filters" class="my-2">
		{% if filters.searchable|length > 0 %}
		<div id="search" class="mb-1">
			<form>
				<div class="input-group">
					<input type="search" class="form-control" name="search_term" placeholder="..." value="{{ filters.search_term }}" />
					<button type="submit" class="btn btn-dark fw-bold">Search</button>
				</div>
			</form>
		</div>
		{% endif %}
		<div id="filter-links" class="w-100">
			{% for i,link in filters.links %}
			<span class="badge bg-light"><a class="filter-link link-dark {% if filters.filter_link == i %}active{% endif %}" href="?filter_link={{ i }}">{{ link }} [<span hx-swap="textContent" hx-trigger="load" hx-get="?filter_count={{ i }}" hx-target="this">...</span>]</a></span>
			{% endfor %}
		</div>
	</section>
{% endblock %}

{% block middle %}
<table class="table table-sm caption-top mb-2 {% if table.rows|length > 1 %}table-striped{% endif %}">
	<thead class="sticky-top bg-dark text-light p-0">
		<tr>
			{% for title in table.columns %}
			<th class="p-1" nowrap>{{ title }}</th>
			{% endfor %}
		</tr>
	</thead>
	<tbody>
		{% for row in table.rows %}
		<tr>
			{% for col in row %}
			<td class="p-1" nowrap>{{ col|raw }}</td>
			{% endfor %}
		</tr>
		{% endfor %}
		{% if table.columns|length > 0 and table.rows|length == 0 %}
		<tr>
			<td class="text-center" colspan="{{ table.columns|length }}"><em>No results found</em></td>
		</tr>
		{% endif %}
	</tbody>
</table>
{% endblock %}

{% block bottom %}
{% if pagination.total_pages > 1 %}
<div class="d-flex align-items-center mt-2">
	<nav class="flex-grow-1" aria-label="page navigation">
		<ul class="pagination pagination-sm mb-0">
			<li class="page-item {% if pagination.page < 2 %}disabled{% endif %}"><a class="page-link link-dark" href="?page={{ pagination.page - 1 }}">Previous</a></li>
			{% if pagination.page > 1 %}
			<li class="page-item"><a class="page-link link-dark" href="?page=1">1</a></li>
			<li class="page-item disabled"><span class="page-link link-dark">...</span></li>
			{% endif %}
			<li class="page-item active"><a class="page-link link-dark" href="?page={{ pagination.page }}">{{ pagination.page }}</a></li>
			{% if pagination.page < pagination.total_pages %}
			<li class="page-item disabled"><span class="page-link link-dark">...</span></li>
			<li class="page-item"><a class="page-link link-dark" href="?page={{ pagination.total_pages }}">{{ pagination.total_pages }}</a></li>
			{% endif %}
			<li class="page-item {% if pagination.page >= pagination.total_pages %}disabled{% endif %}"><a class="page-link link-dark" href="?page={{ pagination.page + 1 }}">Next</a></li>
		</ul>
	</nav>
	<select hx-get="" hx-trigger="change" class="form-select form-select-sm" name="per_page" id="per-page">
		<option disabled>Results per page</option>
		{% for i in pagination.page_options %}
		<option value="{{ i }}" {% if i == pagination.per_page %}selected{% endif %}>{{ i }}</option>
		{% endfor %}
	</select>
</div>
{% endif %}
{% endblock %}
